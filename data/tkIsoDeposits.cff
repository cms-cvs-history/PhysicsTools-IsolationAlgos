#pieces needed to run the associator-related stuff
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cff"
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorAny.cfi"
include "TrackingTools/TrackAssociator/data/DetIdAssociatorESProducer.cff" 

include "RecoMuon/MuonIsolationProducers/data/trackExtractorBlocks.cff"
include "RecoMuon/MuonIsolationProducers/data/caloExtractorByAssociatorBlocks.cff"
include "RecoMuon/MuonIsolationProducers/data/jetExtractorBlock.cff"
include "RecoMuon/MuonIsolationProducers/data/caloExtractorBlocks.cff"

include "PhysicsTools/RecoAlgos/data/highPtTracks.cfi"

include "RecoMuon/MuonIsolationProducers/data/isoDepositProducerIOBlocks.cff"
include "RecoMuon/MuonIsolationProducers/data/trackExtractorBlocks.cff"
module tkIsoDepositTk = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = false
  PSet ExtractorPSet =
  {
        using MIsoTrackExtractorBlock
  }
}

include "RecoMuon/MuonIsolationProducers/data/caloExtractorByAssociatorBlocks.cff"
module tkIsoDepositCalByAssociatorTowers = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = true
  PSet ExtractorPSet =
  {
        using MIsoCaloExtractorByAssociatorTowersBlock
  }

}


module tkIsoDepositCalByAssociatorHits = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = true

  PSet ExtractorPSet = {
        using MIsoCaloExtractorByAssociatorHitsBlock
  }
}

include "RecoMuon/MuonIsolationProducers/data/jetExtractorBlock.cff"

module tkIsoDepositJets = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = false
  PSet ExtractorPSet = {
        using MIsoJetExtractorBlock
  }
}

include "RecoMuon/MuonIsolationProducers/data/caloExtractorBlocks.cff"

module tkIsoDepositCalEcal = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = false
  PSet ExtractorPSet =
  {
        using MIsoCaloExtractorEcalBlock
  }
}

module tkIsoDepositCalHcal = CandIsoDepositProducer {
  InputTag src = highPtTracks
  string trackType = "best"
  bool MultipleDepositsFlag = false
  PSet ExtractorPSet =
  {
        using MIsoCaloExtractorHcalBlock
  }
}

##########################################################################
# and now sequences of the above
##########################################################################
# "standard sequence"
sequence tkIsoDeposits = {
  highPtTracks &
  tkIsoDepositTk & 
  tkIsoDepositCalByAssociatorTowers & 
  tkIsoDepositJets 
}
