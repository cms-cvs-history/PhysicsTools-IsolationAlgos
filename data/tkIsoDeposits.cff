#pieces needed to run the associator-related stuff
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cff"
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorAny.cfi"
include "TrackingTools/TrackAssociator/data/DetIdAssociatorESProducer.cff" 

include "RecoMuon/MuonIsolationProducers/data/trackExtractorBlocks.cff"
include "RecoMuon/MuonIsolationProducers/data/caloExtractorByAssociatorBlocks.cff"
include "RecoMuon/MuonIsolationProducers/data/jetExtractorBlock.cff"
include "RecoMuon/MuonIsolationProducers/data/caloExtractorBlocks.cff"

include "PhysicsTools/RecoAlgos/data/highPtTracks.cfi"

module tkIsoDepositTk 
       = candIsoDepositCtfTk from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositCtfTk.cfi"
replace tkIsoDepositTk.src = highPtTracks
replace tkIsoDepositTk.trackType = "best"
#will read generalTracks here
replace tkIsoDepositTk.ExtractorPSet = { using MIsoTrackExtractorBlock }


#candIsoDeposit maker for highPtTracks based on TrackAssociator using towers
module tkIsoDepositCalByAssociatorTowers 
       = candIsoDepositCalByAssociatorTowers from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositCalByAssociatorTowers.cfi"
replace tkIsoDepositCalByAssociatorTowers.src = highPtTracks
replace tkIsoDepositCalByAssociatorTowers.trackType = "best"

#candIsoDeposit maker for highPtTracks based on TrackAssociator using rec-hits
module tkIsoDepositCalByAssociatorHits 
       = candIsoDepositCalByAssociatorHits from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositCalByAssociatorHits.cfi"
replace tkIsoDepositCalByAssociatorHits.src = highPtTracks
replace tkIsoDepositCalByAssociatorHits.trackType = "best"

#candIsoDeposit maker for highPtTracks based on TrackAssociator using towers
module tkIsoDepositJets 
       = candIsoDepositJets from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositJets.cfi"
replace tkIsoDepositJets.src = highPtTracks
replace tkIsoDepositJets.trackType = "best"

#Ecal-only candIsoDeposit using CaloExtractor for 
module tkIsoDepositCalEcal = candIsoDepositCal from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositCal.cfi"
replace tkIsoDepositCalEcal.src = highPtTracks
replace tkIsoDepositCalEcal.trackType = "best"
replace tkIsoDepositCalEcal.ExtractorPSet = { using MIsoCaloExtractorEcalBlock }


#Hcal-only candIsoDeposit using CaloExtractor for 
module tkIsoDepositCalHcal = candIsoDepositCal from "PhysicsTools/IsolationAlgos/test/mu/candIsoDepositCal.cfi"
replace tkIsoDepositCalHcal.src = highPtTracks
replace tkIsoDepositCalHcal.trackType = "best"
replace tkIsoDepositCalHcal.ExtractorPSet = { using MIsoCaloExtractorHcalBlock }


##########################################################################
# and now sequences of the above
##########################################################################
# "standard sequence"
sequence tkIsoDeposits = {
  highPtTracks &
  tkIsoDepositTk & 
  tkIsoDepositCalByAssociatorTowers & 
  tkIsoDepositJets 
}
